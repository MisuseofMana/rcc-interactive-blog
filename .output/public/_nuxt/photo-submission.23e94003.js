import O from"./DisLogo.7a9cf9de.js";import W from"./CBToggleSwitch.d3379471.js";import{V as X,a as T,_ as J}from"./CBDropdownSelect.129af2f8.js";import K from"./CBFileInput.bbd49928.js";import Q from"./CBTextField.635aa0b5.js";import Y from"./CBTextArea.10efc8fb.js";import{_ as Z}from"./backButton.3ed8edb3.js";import{_ as ee}from"./layout.e323096b.js";import{g as te}from"./composables.db01eee4.js";import{m as ae,R as oe,S as se,r as y,k as le,U as ie,V as re,W as ne,v as me,X as ce,x as de,o as w,c as k,w as t,a as e,d as R,e as a,u as r,t as B,g as L,b as ue}from"./entry.af4b25f0.js";import{c as pe,a as V,b as fe,d as U}from"./index.esm.f2d381c7.js";import{a as he}from"./useRealmNames.4e993d8d.js";import{c as be,V as ge,a as _e,b as xe,d as ye}from"./VExpansionPanel.f184d897.js";import{V as d,a as n}from"./VRow.afde100a.js";import{V as ve}from"./VCard.1acd0fd0.js";import{V as we}from"./VImg.732dd834.js";import{V as Ve}from"./VProgressLinear.58e0b888.js";import{V as Ie}from"./VSnackbar.96a565f4.js";import{V as Se}from"./VBtn.b508a718.js";import{V as Ce}from"./VContainer.84ccdb61.js";import"./VSelectionControl.a37bcff4.js";import"./density.a43ed496.js";import"./useRender.711bb119.js";import"./index.8efa490c.js";import"./color.16bf09b2.js";import"./VIcon.4c30e4d0.js";import"./tag.622ed0d5.js";import"./VInput.6cafeb98.js";import"./index.72f797fd.js";import"./transition.c0b5a353.js";import"./loader.a28a0d31.js";import"./VProgressCircular.a0eacb68.js";import"./resizeObserver.f5995fd7.js";import"./VTextField.6cbfc730.js";/* empty css                   */import"./forwardRefs.a44f5a39.js";import"./index.26545022.js";import"./VOverlay.400edcb4.js";import"./dimensions.85878954.js";import"./router.4d4a04cb.js";import"./hydration.80aaf091.js";import"./createSimpleFunctional.e260b764.js";import"./elevation.c0c3c7d4.js";import"./rounded.2773415e.js";import"./VAvatar.1cb02f40.js";import"./VChip.b3e2a517.js";import"./group.2a175b20.js";import"./useSiteStore.bfcdeead.js";import"./position.6ecf00cf.js";const Te=a("h1",{class:"text-h1 mb-5"},"Submit New Photo",-1),ke=a("p",{class:"text-body-1 ml-10"},"Form N-PHT:C1",-1),Re=a("p",{class:"text-body-2 ml-10 mb-3"},"New Photo - Clearance 1",-1),Be=a("ol",{class:"text-decoration-none"},[a("li",{class:"text-body-1 ml-10 mb-1"},"Use form N-PHT to submit a new photo to the archives."),a("li",{class:"text-body-1 ml-10"},"Submitted photos will be approved by a Director at the DIS.")],-1),Le=a("p",{class:"text-subtitle-1"},"Read N-PHT Submission Guidelines before using this form.",-1),Ue=a("p",{class:"text-subtitle-1"},"Improper submissions will be rejected and potentially lead to forefiture of your clearance.",-1),Pe=a("ul",{class:"px-8 text-subtitle-2"},[a("li",null,"Realm Photos should avoid depicting humans or animals unless narratively important to the Lore of the realm."),a("ul",{class:"ml-5"},[a("li",null,"If deemed necessary to realm Lore, human and animal depictions should be obfuscated in some way. The people or animals in question should be depicted in and unidentifiable way to protect an overall feeling of liminal space.")]),a("li",null,"Realm photos should depict the world first and foremost."),a("li",null,"Photos must be landscape orientation.")],-1),Ne=a("ul",{class:"px-8 text-subtitle-2"},[a("li",null,'"Use as Cover Image" should be toggled on if the image submitted should be displayed as the portal image on the /realms directory.'),a("li",null,'"Image has Semiotics" should be toggled on if the image has been modified to contain a numeric semiotic. Denotes that this image will be used for the Operator Exam.')],-1),Fe={class:"text-primary minHeight text-body-1 mx-8 px-5 py-5 text-center"},$e={key:1,class:"text-body-1 text-deep-orange-darken-4"},Ae=a("p",{class:"text-primary text-body-2"}," Upload Succeeded ",-1),Ee=a("canvas",{class:"d-none",id:"compression-canvas",width:"700",height:"466"},null,-1),Ft={__name:"photo-submission",async setup(De){let f,I;const P=be("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",15),{nameList:N}=he(),F=ae(),$=oe(),A=([f,I]=se(()=>te()),f=await f,I(),f),h=y(0),b=y([]),v=y(""),g=y(!1),E={realm:"",imageFile:[],lore:"",altText:"",isCoverImage:!1,hasSemiotic:!1},D=async s=>{b.value[0]=URL.createObjectURL(s.target.files[0]);const o=new Image;o.src=b.value[0],o.onload=()=>{const[m,l]=H(o,700,466);document.getElementById("compression-canvas").getContext("2d").drawImage(o,0,0,m,l)}},H=(s,o,m)=>{let l=s.width,i=s.height;return l>i?l>o&&(i=Math.round(i*o/l),l=o):i>m&&(l=Math.round(l*m/i),i=m),[l,i]},{values:j,handleSubmit:q,errors:_,resetForm:z,isSubmitting:p}=le({initialValues:E,validationSchema:pe().shape({realm:V().required().label("Realm Name"),imageFile:fe().required().label("Image Upload"),altText:V().nullable().max(150).label("Image Alt Text"),lore:V().max(120).required().label("Image Lore"),isCoverImage:U().label("Use As Cover Image"),hasSemiotic:U().label("Image has Semiotic")})}),G=q(s=>{h.value=0;const o=P(),m=ie($,`${s.realm}/photographs/${o}`);document.getElementById("compression-canvas").toBlob(i=>{let x=new File([i],s.imageFile[0].name);re(m,x).on("state_changed",c=>{h.value=c.bytesTransferred/c.totalBytes*100},c=>{v.value=c},()=>{ne(m).then(c=>{me(de(F,"realms",s.realm,"photographs",o),{realmId:s.realm,altText:s.altText?s.altText:s.lore,lore:s.lore,submittedAt:ce(),submittedBy:A.displayName,published:!1,imageLink:c,useAsCoverImage:s.isCoverImage,hasSemiotic:s.hasSemiotic,order:null}).then(()=>{z({values:{realm:s.realm,imageFile:[],lore:"",altText:"",isCoverImage:!1,hasSemiotic:!1}}),b.value=[]})}),g.value=!0})},"image/webp",1)});return(s,o)=>{const m=O,l=W,i=J,x=K,S=Q,c=Y,C=Z,M=ee;return w(),k(M,{name:"sub-admin"},{default:t(()=>[e(Ce,{class:"my-5"},{default:t(()=>[e(d,null,{default:t(()=>[e(n,{cols:"12",sm:"2",class:"mb-5 d-flex align-center justify-center"},{default:t(()=>[e(m)]),_:1}),e(n,{cols:"12",sm:"5",class:"mb-5 d-flex align-center"},{default:t(()=>[Te]),_:1}),e(n,{cols:"12",sm:"5",class:"mb-5 d-flex align-center"},{default:t(()=>[e(ve,{variant:"outlined",class:"pa-5 mr-5"},{default:t(()=>[ke,Re,Be]),_:1})]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(n,{cols:"12",class:"mb-5 text-info"},{default:t(()=>[Le,Ue]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(n,{class:"mb-5"},{default:t(()=>[e(ge,null,{default:t(()=>[e(_e,null,{default:t(()=>[e(xe,null,{default:t(()=>[R(" N-PHT Submission Guidelines ")]),_:1}),e(ye,null,{default:t(()=>[e(X,{lines:"two"},{default:t(()=>[e(T,{title:"Briefing",subtitle:"Realm photos are intended to be thematic representations of a realm and follow the rules below."}),Pe,e(T,{title:"Toggle Switches",subtitle:"There are two toggle switches for this form, they are to be used for the following situations."}),Ne]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a("form",null,[e(d,null,{default:t(()=>[e(n,{cols:"3"},{default:t(()=>[e(l,{name:"isCoverImage",label:"Use as Cover Image"})]),_:1}),e(n,{cols:"3"},{default:t(()=>[e(l,{name:"hasSemiotic",label:"Image Has Semiotic"})]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(n,{cols:"12",md:"5",class:"mb-5 text-primary"},{default:t(()=>[e(i,{class:"mb-5",errors:r(_).realm,hint:"Select the realm you wish to submit evidence of.",items:r(N),label:"Submit To Which Realm?",name:"realm"},null,8,["errors","items"]),e(x,{class:"mb-5",errors:r(_).imageFile,hint:"Upload an image representing one of the existing realms.",label:"Realm Image Upload",name:"imageFile",onChange:o[0]||(o[0]=u=>D(u))},null,8,["errors"]),e(S,{class:"mb-5",label:"Realm Image Alt Text",name:"altText",hint:"The alternative text to be used by screen readers. If left blank, Lore will become the alt text. ","error-messages":r(_).altText},null,8,["error-messages"]),e(c,{name:"lore",label:"Realm Image Lore",errors:r(_).lore,hint:"Should be musing information about the realm. Two short sentences or sentence fragments are appropriate."},null,8,["errors"])]),_:1}),e(n,{cols:"12",md:"7"},{default:t(()=>[e(we,{src:b.value[0],id:"imagePreview",class:"realmImage","aspect-ratio":"1.5",cover:"","lazy-src":"/images/mocks/placeholder-wide.jpg",alt:"an image to submit documented from another realm"},null,8,["src"]),a("p",Fe,B(r(j).lore),1)]),_:1})]),_:1}),e(d,{class:"mt-10"},{default:t(()=>[e(n,{cols:"6",xl:"6"},{default:t(()=>[e(C,{caution:!0,variant:"outlined","link-name":"/operations/control",isLoading:r(p),disabled:r(p),text:"Cancel"},null,8,["isLoading","disabled"])]),_:1}),e(n,{cols:"6",xl:"6"},{default:t(()=>[e(C,{onClick:r(G),color:"primary-darken-1",class:"text-primary",isLoading:r(p),disabled:r(p),text:"Submit"},null,8,["onClick","isLoading","disabled"])]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(n,{cols:"12",md:"8",class:"mb-4 offset-md-3"},{default:t(()=>[r(p)?(w(),k(Ve,{key:0,"bg-color":"primary",color:"primary",rounded:"",stream:"",height:"12px",modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=u=>h.value=u),class:"mb-3"},null,8,["modelValue"])):L("",!0),v.value?(w(),ue("div",$e,B(v.value),1)):L("",!0)]),_:1})]),_:1})]),e(Ie,{modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=u=>g.value=u),timer:"",timeout:"1500"},{actions:t(()=>[e(Se,{color:"primary",variant:"text",onClick:o[2]||(o[2]=u=>g.value=!1)},{default:t(()=>[R(" Close ")]),_:1})]),default:t(()=>[Ae]),_:1},8,["modelValue"])]),_:1}),Ee]),_:1})}}};export{Ft as default};
