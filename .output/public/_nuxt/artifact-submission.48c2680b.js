import O from"./DisLogo.64a5fd79.js";import{V as W,a as V,_ as X}from"./CBDropdownSelect.599b193d.js";import H from"./CBFileInput.dee11c68.js";import J from"./CBTextField.255ef873.js";import K from"./CBTextArea.9d340382.js";import{_ as Q}from"./backButton.b4a42b8e.js";import{_ as Y}from"./layout.11a375a8.js";import{g as Z}from"./composables.855071af.js";import{m as ee,R as te,S as ae,r as g,k as se,U as oe,V as re,W as le,y as ie,X as ne,z as me,o as C,c as k,w as t,a as e,d as A,e as i,u as r,t as S,g as R,b as ce}from"./entry.94ffdeeb.js";import{c as de,a as w,b as ue}from"./index.esm.f2d381c7.js";import{a as pe}from"./useRealmNames.18b4ffd2.js";import{c as fe,V as be,a as ge,b as _e,d as he}from"./VExpansionPanel.83674530.js";import{V as u,a as m}from"./VRow.874663fa.js";import{V as xe}from"./VCard.9eec5110.js";import{V as ye}from"./VImg.9336a433.js";import{V as Ve}from"./VProgressLinear.7e39016e.js";import{V as we}from"./VSnackbar.f99cdf2a.js";import{V as ve}from"./VBtn.d2531af0.js";import{V as Te}from"./VContainer.26342d42.js";import"./VTextField.5390ceef.js";/* empty css                   */import"./forwardRefs.14bdb9d9.js";import"./index.108b6c93.js";import"./VInput.6e31d692.js";import"./useRender.ee02d324.js";import"./density.5a2b29f1.js";import"./VIcon.a89c1bf3.js";import"./tag.6e0eec08.js";import"./color.08edc865.js";import"./transition.7408c173.js";import"./loader.0e188cc9.js";import"./index.66b8fb70.js";import"./VOverlay.a8c9058d.js";import"./dimensions.2a8a239a.js";import"./router.12029284.js";import"./hydration.f2ecb7c8.js";import"./createSimpleFunctional.433ad74c.js";import"./index.5bd91e98.js";import"./rounded.a3340ae4.js";import"./VAvatar.7d2681a0.js";import"./VSelectionControl.dc270e61.js";import"./VChip.c096698a.js";import"./group.e7d6c6fc.js";import"./useSiteStore.7e6abfbd.js";import"./position.048a6b63.js";import"./VProgressCircular.6669da86.js";import"./resizeObserver.16ca977f.js";const Ce=i("h1",{class:"text-h1 mb-5"},"Submit New Artifact",-1),Ie=i("p",{class:"text-body-1 ml-10"},"Form N-RTFCT:C1",-1),Ne=i("p",{class:"text-body-2 ml-10 mb-3"},"New Artifact - Clearance 1",-1),ke=i("ol",{class:"text-decoration-none"},[i("li",{class:"text-body-1 ml-10 mb-1"},"Use form N-RTFCT to submit a new artifact to the archives."),i("li",{class:"text-body-1 ml-10"},"Submitted artifacts will be approved by a Director at the DIS.")],-1),Ae=i("p",{class:"text-subtitle-1"},"Read N-RTFCT Submission Guidelines before using this form.",-1),Se=i("p",{class:"text-subtitle-1"},"Improper submissions will be rejected and potentially lead to forefiture of your clearance.",-1),Re={class:"text-primary minHeight text-body-1 mx-8 px-5 py-5 text-center"},Be={key:1,class:"text-body-1 text-deep-orange-darken-4"},Fe=i("p",{class:"text-primary text-body-2"}," Upload Succeeded ",-1),Le=i("canvas",{class:"d-none",id:"compression-canvas",width:"500",height:"500"},null,-1),At={__name:"artifact-submission",async setup(Ue){let _,I;const B=fe("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",15),{nameList:F}=pe(),L=ee(),U=te(),$=([_,I]=ae(()=>Z()),_=await _,I(),_),h=g(0),x=g([]),v=g(""),y=g(!1),T=g(!1),E={realm:"",imageFile:[],lore:"",altText:""},P=async s=>{x.value[0]=URL.createObjectURL(s.target.files[0]);const a=new Image;a.src=x.value[0],a.onload=()=>{const[n,l]=D(a,700,700),o=document.getElementById("compression-canvas");o.width=a.width,o.height=a.height,o.getContext("2d").drawImage(a,0,0,n,l)}},D=(s,a,n)=>{let l=s.width,o=s.height;return l>o?(T.value=!1,l>a&&(o=Math.round(o*a/l),l=a)):(T.value=!0,o>n&&(l=Math.round(l*n/o),o=n)),[l,o]},{values:q,handleSubmit:j,errors:p,resetForm:z,isSubmitting:f}=se({initialValues:E,validationSchema:de().shape({realm:w().required().label("Realm Name"),imageFile:ue().required().label("Image Upload"),altText:w().nullable().max(150).label("Image Alt Text"),lore:w().max(200).required().label("Image Lore"),imageName:w().label("Image Name")})}),G=j(s=>{h.value=0;const a=B(),n=oe(U,`${s.realm}/artifacts/${a}`);document.getElementById("compression-canvas").toBlob(o=>{let b=new File([o],s.imageFile[0].name);re(n,b).on("state_changed",c=>{h.value=c.bytesTransferred/c.totalBytes*100},c=>{v.value=c},()=>{le(n).then(c=>{ie(me(L,"realms",s.realm,"artifacts",a),{realmId:s.realm,altText:s.altText?s.altText:s.lore,lore:s.lore,submittedAt:ne(),submittedBy:$.displayName,published:!1,imageLink:c,title:s.imageName,isVertical:T.value}).then(()=>{z({values:{realm:s.realm,imageFile:[],lore:"",altText:"",imageName:""}}),x.value=[]})}),y.value=!0})},"image/webp",1)});return(s,a)=>{const n=O,l=X,o=H,b=J,N=K,c=Q,M=Y;return C(),k(M,{name:"sub-admin"},{default:t(()=>[e(Te,{class:"my-5"},{default:t(()=>[e(u,null,{default:t(()=>[e(m,{cols:"12",sm:"2",class:"mb-5 d-flex align-center justify-center"},{default:t(()=>[e(n)]),_:1}),e(m,{cols:"12",sm:"5",class:"mb-5 d-flex align-center"},{default:t(()=>[Ce]),_:1}),e(m,{cols:"12",sm:"5",class:"mb-5 d-flex align-center"},{default:t(()=>[e(xe,{variant:"outlined",class:"pa-5 mr-5"},{default:t(()=>[Ie,Ne,ke]),_:1})]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(m,{cols:"12",class:"mb-5 text-info"},{default:t(()=>[Ae,Se]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(m,{class:"mb-5"},{default:t(()=>[e(be,null,{default:t(()=>[e(ge,null,{default:t(()=>[e(_e,null,{default:t(()=>[A(" N-RTFCT Submission Guidelines ")]),_:1}),e(he,null,{default:t(()=>[e(W,{lines:"two"},{default:t(()=>[e(V,{title:"Briefing",subtitle:"Artifacts are intended to be narrative aids for the realms. When submitting artifacts, they must be imagery taken from thrifted publications, vintage illustrations, or otherwise physical scans of historic media."}),e(V,{title:"Preservation",subtitle:"The aim of archiving these thrifted or otherwise images is to preserve and repurpose old imagery that would have otherwise gone to waste."}),e(V,{title:"Requirements",subtitle:"All submitted artifacts must be categorized and submitted to the appropriate realm. If you are uncertain which realm to submit to, select UNCERTAIN."}),e(V,{title:"Appearance",subtitle:"Artifacts must be high quality scans, aim for 300dpi. Artifacts should be preferrably of illustrative imagery, and be submitted in black and white."})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i("form",null,[e(u,null,{default:t(()=>[e(m,{cols:"12",md:"5",class:"mb-5 text-primary"},{default:t(()=>[e(l,{class:"mb-5",errors:r(p).realm,hint:"Select the realm you wish to submit to.",items:r(F),label:"Submit To Which Realm?",name:"realm"},null,8,["errors","items"]),e(o,{class:"mb-5",errors:r(p).imageFile,hint:"Upload an image representing one of the existing realms.",label:"Artifact Image Upload",name:"imageFile",onChange:a[0]||(a[0]=d=>P(d))},null,8,["errors"]),e(b,{class:"mb-5",label:"Artifact Image Name",name:"imageName",hint:"A name to display alongside the artifact.","error-messages":r(p).imageName},null,8,["error-messages"]),e(b,{class:"mb-5",label:"Artifact Image Alt Text",name:"altText",hint:"The alternative text to be used by screen readers. If left blank, Artifact Lore will become the alt text. ","error-messages":r(p).altText},null,8,["error-messages"]),e(N,{name:"lore",label:"Artifact Lore",counter:"200",errors:r(p).lore,hint:"Should be musing information about the artifact. One or two short sentences or sentence fragments are appropriate."},null,8,["errors"])]),_:1}),e(m,{cols:"12",md:"7"},{default:t(()=>[e(ye,{src:x.value[0],id:"imagePreview",class:"realmImage","lazy-src":"/images/mocks/placeholder-wide.jpg",alt:"an image to submit documented from another realm"},null,8,["src"]),i("p",Re,S(r(q).lore),1)]),_:1})]),_:1}),e(u,{class:"mt-10"},{default:t(()=>[e(m,{cols:"6",xl:"6"},{default:t(()=>[e(c,{warning:"",variant:"outlined","link-name":"/operations/control",isLoading:r(f),disabled:r(f),text:"Cancel"},null,8,["isLoading","disabled"])]),_:1}),e(m,{cols:"6",xl:"6"},{default:t(()=>[e(c,{onClick:r(G),color:"primary-darken-1",class:"text-primary",isLoading:r(f),disabled:r(f),text:"Submit"},null,8,["onClick","isLoading","disabled"])]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(m,{cols:"12",md:"8",class:"mb-4 offset-md-3"},{default:t(()=>[r(f)?(C(),k(Ve,{key:0,"bg-color":"primary",color:"primary",rounded:"",stream:"",height:"12px",modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=d=>h.value=d),class:"mb-3"},null,8,["modelValue"])):R("",!0),v.value?(C(),ce("div",Be,S(v.value),1)):R("",!0)]),_:1})]),_:1})]),e(we,{modelValue:y.value,"onUpdate:modelValue":a[3]||(a[3]=d=>y.value=d)},{actions:t(()=>[e(ve,{color:"primary",variant:"text",onClick:a[2]||(a[2]=d=>y.value=!1)},{default:t(()=>[A(" Close ")]),_:1})]),default:t(()=>[Fe]),_:1},8,["modelValue"])]),_:1}),Le]),_:1})}}};export{At as default};
