import{_ as z}from"./backButton.b4a42b8e.js";import{_ as M}from"./CBDropdownSelect.599b193d.js";import G from"./CBTextField.255ef873.js";import P from"./CBTextArea.9d340382.js";import{_ as Z}from"./layout.11a375a8.js";import{g as H}from"./composables.855071af.js";import{S as J,r as b,m as K,q as Q,k as W,Y as X,Z as ee,z as C,y as te,$ as ae,o as h,c as T,w as t,a0 as se,a1 as oe,a2 as le,a3 as re,a4 as ne,a as e,T as me,u as m,b as j,e as i,g as ie,a5 as ce,h as ue,F as pe,t as A}from"./entry.94ffdeeb.js";import{c as N,b as de,a as S}from"./index.esm.f2d381c7.js";import{a as _e}from"./useRealmNames.18b4ffd2.js";import{u as fe,a as ve}from"./useSiteStore.7e6abfbd.js";import{V as _,a as r}from"./VRow.874663fa.js";import{V as be}from"./VContainer.26342d42.js";import{V as he}from"./VCard.9eec5110.js";import{V as B}from"./VOverlay.a8c9058d.js";import{V as ge}from"./VImg.9336a433.js";import"./VIcon.a89c1bf3.js";import"./tag.6e0eec08.js";import"./color.08edc865.js";import"./useRender.ee02d324.js";import"./VBtn.d2531af0.js";import"./router.12029284.js";import"./density.5a2b29f1.js";import"./rounded.a3340ae4.js";import"./group.e7d6c6fc.js";import"./index.5bd91e98.js";import"./dimensions.2a8a239a.js";import"./loader.0e188cc9.js";import"./VProgressLinear.7e39016e.js";import"./position.048a6b63.js";import"./VProgressCircular.6669da86.js";import"./resizeObserver.16ca977f.js";import"./VTextField.5390ceef.js";/* empty css                   */import"./forwardRefs.14bdb9d9.js";import"./index.108b6c93.js";import"./VInput.6e31d692.js";import"./transition.7408c173.js";import"./index.66b8fb70.js";import"./createSimpleFunctional.433ad74c.js";import"./VAvatar.7d2681a0.js";import"./VSelectionControl.dc270e61.js";import"./VChip.c096698a.js";import"./hydration.f2ecb7c8.js";const ye=i("h1",{class:"text-h1 text-center mb-4"},"Photo Approval",-1),ke={key:0},xe={class:"text-deep-orange-darken-1 d-flex align-center justify-center"},Ce=i("h2",{class:"text-h4"},"Are you sure you want to approve this submission?",-1),Se=i("p",{class:"text-body-1 mb-8"},"Submission approval is only reversable by a member of the D.I.S.",-1),Ve=i("h2",{class:"text-h4 mb-2"},"Are you sure you want to reject this submission?",-1),$e=i("p",{class:"text-body-1 mb-8"},"Rejecting a submission can not be undone.",-1),we={class:"text-body-1 text-primary mb-2"},Ie={class:"text-body-1 text-primary mb-4"},gt={__name:"photo-approval",async setup(Le){let f,V;_e();const F=fe(),R=([f,V]=J(()=>H()),f=await f,V(),f),U=b(0),u=b([]),p=b([]),c=b(!1),v=K(),$=async()=>{const s=se(re(v,"photographs"),le("published","==",!1),oe(4));(await ne(s)).forEach(o=>{q({...o.data(),photoId:o.id}),u.value.push(!1),p.value.push(!1)})};Q(()=>{$()});const{handleSubmit:w,errors:g}=W({validationSchema:N().shape({submissions:de().of(N().shape({realmId:S().required().label("Realm Name"),altText:S().nullable().max(150).label("Image Alt Text"),lore:S().max(120).required().label("Image Lore")}))})}),{remove:D,push:q,fields:I}=X("submissions"),L=s=>{D(s),c.value=!1,u.value[s]=!1,p.value[s]=!1,U.value--},E=w(({submissions:s},{evt:l})=>{c.value=!0;const{realmId:o,photoId:y,lore:k,altText:x}=s[l];ee(C(v,"realms",realm,"photographs",y),{published:!0,lore:k,altText:x,realmId:o}).then(()=>{L(l)})}),O=w(({submissions:s},{evt:l})=>{c.value=!0,te(C(v,"users",R.uid,"rejections",s[l].imageId),{...s[l],rejectionReason:""}).then(()=>{ae(C(v,"submissions",s[l].imageId)),L(l)})});return(s,l)=>{const o=z,y=M,k=G,x=P,Y=Z;return h(),T(Y,{name:"sub-admin"},{default:t(()=>[e(be,{class:"my-5"},{default:t(()=>[e(_,{class:"mb-15"},{default:t(()=>[e(r,{cols:"12"},{default:t(()=>[ye]),_:1})]),_:1}),e(me,{name:"collapse"},{default:t(()=>[m(I).length?ie("",!0):(h(),j("div",ke,[e(_,null,{default:t(()=>[e(r,{cols:"12",md:"4",class:"offset-md-4"},{default:t(()=>[i("div",xe,[e(o,{rounded:"",text:"Check For More Submissions","front-icon":"magnify",onClick:l[0]||(l[0]=d=>$())})])]),_:1})]),_:1})]))]),_:1}),e(ce,{name:"collapse"},{default:t(()=>[(h(!0),j(pe,null,ue(m(I),(d,a)=>(h(),T(he,{variant:"outlined",color:"primary-darken-1",class:"pa-15 text-primary mb-8",key:d.value.imageId},{default:t(()=>[e(B,{modelValue:u.value[a],"onUpdate:modelValue":n=>u.value[a]=n,contained:"",class:"align-center background-red justify-center text-primary text-center approvalScrim"},{default:t(()=>[Ce,Se,e(_,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",text:"Yes, Approve This Submission","realm-icons":["check"],onClick:n=>m(E)(a),isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024),e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",warning:!0,variant:"outlined",text:"No, wait. Nevermind.",isLoading:c.value,"realm-icons":["cancel"],onClick:n=>u.value[a]=!1},null,8,["isLoading","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(B,{modelValue:p.value[a],"onUpdate:modelValue":n=>p.value[a]=n,contained:"",class:"align-center background-red justify-center text-primary text-center rejectionScrim"},{default:t(()=>[Ve,$e,e(_,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",text:"Yes, Reject This Submission","realm-icons":["trash-can"],onClick:n=>m(O)(a),isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024),e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",warning:!0,variant:"outlined",text:"No, wait. Nevermind.","realm-icons":["cancel"],onClick:n=>p.value[a]=!1,isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(_,{class:"text-primary"},{default:t(()=>[e(r,{cols:"12",lg:"7"},{default:t(()=>[e(ge,{class:"realmImage mb-5",cover:"",src:d.value.imageLink,"lazy-src":"/images/mocks/placeholder-wide.jpg",alt:d.value.altText},null,8,["src","alt"])]),_:2},1024),e(r,{cols:"12",lg:"5"},{default:t(()=>[e(y,{class:"text-primary",errors:m(g)[`submissions[${a}].realm`],items:m(F).realmNames,hint:null,label:"Realm Name",name:`submissions[${a}].realmId`},null,8,["errors","items","name"]),e(k,{class:"text-primary",label:"Image Alt Text",name:`submissions[${a}].altText`,hint:null,"error-messages":m(g).altText},null,8,["name","error-messages"]),e(x,{name:`submissions[${a}].lore`,label:"Image Lore",errors:m(g)[`submissions[${a}].lore`]},null,8,["name","errors"]),i("p",we,":> Submitted by: "+A(d.value.submittedBy),1),i("p",Ie,":> Submitted around "+A(m(ve)(d.value.submittedAt).lastUpdated.value)+" ago",1),e(_,{class:"d-flex"},{default:t(()=>[e(r,{cols:"12",lg:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",text:"Approve","realm-icons":["key"],onClick:n=>u.value[a]=!0},null,8,["onClick"])]),_:2},1024),e(r,{cols:"12",lg:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",warning:"",variant:"outlined",text:"Reject","realm-icons":["cancel"],onClick:n=>p.value[a]=!0},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}};export{gt as default};
