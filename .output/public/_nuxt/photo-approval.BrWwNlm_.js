import{aa as E,r as v,a as M,o as Y,u as G,ah as P,ai as H,d as C,m as J,aj as K,e as S,f as e,w as a,ak as Q,al as W,am as X,an as Z,ao as ee,h,s as ae,V as _,j as r,T as te,p as m,l as i,v as se,ap as oe,F as le,z as re,_ as ne,i as me,k as ie,B as ce,t as T}from"./entry.ChAOt23L.js";import{_ as ue}from"./CBDropdownSelect.BV4LXBan.js";import de from"./CBTextField.IYujbuPa.js";import pe from"./CBTextArea.DCFtSest.js";import{_ as _e}from"./nuxt-layout.DzOhEKpg.js";import{g as fe}from"./composables.DzwuPr63.js";import{c as B,b as be,a as V}from"./index.esm.tasc2V0i.js";import{a as ve}from"./useRealmNames.NDbBi-9B.js";import{u as he,a as ge}from"./useSiteStore.Cb1hoYNs.js";import{V as N}from"./VOverlay.DeNzZdw9.js";import"./VTextField.BbbjzV6O.js";/* empty css                   */import"./forwardRefs.DBkb97Kd.js";import"./index.DyE5CYnW.js";import"./VInput.BunHh4GF.js";import"./ssrBoot.CGlZkHq_.js";import"./VSelectionControl.D32WVPZV.js";import"./VChip.I-1oQ-CN.js";import"./_commonjsHelpers.Cpj98o6Y.js";const ye=i("h1",{class:"text-h1 text-center mb-4"},"Photo Approval",-1),ke={key:0},xe={class:"text-deep-orange-darken-1 d-flex align-center justify-center"},Ce=i("h2",{class:"text-h4"},"Are you sure you want to approve this submission?",-1),Se=i("p",{class:"text-body-1 mb-8"},"Submission approval is only reversable by a member of the D.I.S.",-1),Ve=i("h2",{class:"text-h4 mb-2"},"Are you sure you want to reject this submission?",-1),$e=i("p",{class:"text-body-1 mb-8"},"Rejecting a submission can not be undone.",-1),je={class:"text-body-1 text-primary mb-2"},we={class:"text-body-1 text-primary mb-4"},Ke={__name:"photo-approval",async setup(Ie){let f,$;ve();const A=he(),R=([f,$]=E(()=>fe()),f=await f,$(),f),F=v(0),u=v([]),d=v([]),c=v(!1),b=M(),j=async()=>{const s=Q(Z(b,"photographs"),X("published","==",!1),W(4));(await ee(s)).forEach(o=>{D({...o.data(),photoId:o.id}),u.value.push(!1),d.value.push(!1)})};Y(()=>{j()});const{handleSubmit:w,errors:g}=G({validationSchema:B().shape({submissions:be().of(B().shape({realmId:V().required().label("Realm Name"),altText:V().nullable().max(150).label("Image Alt Text"),lore:V().max(120).required().label("Image Lore")}))})}),{remove:U,push:D,fields:I}=P("submissions"),L=s=>{U(s),c.value=!1,u.value[s]=!1,d.value[s]=!1,F.value--},O=w(({submissions:s},{evt:l})=>{c.value=!0;const{realmId:o,photoId:y,lore:k,altText:x}=s[l];H(C(b,"realms",realm,"photographs",y),{published:!0,lore:k,altText:x,realmId:o}).then(()=>{L(l)})}),q=w(({submissions:s},{evt:l})=>{c.value=!0,J(C(b,"users",R.uid,"rejections",s[l].imageId),{...s[l],rejectionReason:""}).then(()=>{K(C(b,"submissions",s[l].imageId)),L(l)})});return(s,l)=>{const o=ne,y=ue,k=de,x=pe,z=_e;return h(),S("div",null,[e(z,{name:"sub-admin"},{default:a(()=>[e(ae,{class:"my-5"},{default:a(()=>[e(_,{class:"mb-15"},{default:a(()=>[e(r,{cols:"12"},{default:a(()=>[ye]),_:1})]),_:1}),e(te,{name:"collapse"},{default:a(()=>[m(I).length?se("",!0):(h(),S("div",ke,[e(_,null,{default:a(()=>[e(r,{cols:"12",md:"4",class:"offset-md-4"},{default:a(()=>[i("div",xe,[e(o,{rounded:"",text:"Check For More Submissions","front-icon":"magnify",onClick:l[0]||(l[0]=p=>j())})])]),_:1})]),_:1})]))]),_:1}),e(oe,{name:"collapse"},{default:a(()=>[(h(!0),S(le,null,re(m(I),(p,t)=>(h(),me(ie,{variant:"outlined",color:"primary-darken-1",class:"pa-15 text-primary mb-8",key:p.value.imageId},{default:a(()=>[e(N,{modelValue:u.value[t],"onUpdate:modelValue":n=>u.value[t]=n,contained:"",class:"align-center background-red justify-center text-primary text-center approvalScrim"},{default:a(()=>[Ce,Se,e(_,null,{default:a(()=>[e(r,{cols:"12",md:"6"},{default:a(()=>[e(o,{class:"mr-2 mb-3",text:"Yes, Approve This Submission","realm-icons":["check"],onClick:n=>m(O)(t),isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024),e(r,{cols:"12",md:"6"},{default:a(()=>[e(o,{class:"mr-2 mb-3",warning:!0,variant:"outlined",text:"No, wait. Nevermind.",isLoading:c.value,"realm-icons":["cancel"],onClick:n=>u.value[t]=!1},null,8,["isLoading","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(N,{modelValue:d.value[t],"onUpdate:modelValue":n=>d.value[t]=n,contained:"",class:"align-center background-red justify-center text-primary text-center rejectionScrim"},{default:a(()=>[Ve,$e,e(_,null,{default:a(()=>[e(r,{cols:"12",md:"6"},{default:a(()=>[e(o,{class:"mr-2 mb-3",text:"Yes, Reject This Submission","realm-icons":["trash-can"],onClick:n=>m(q)(t),isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024),e(r,{cols:"12",md:"6"},{default:a(()=>[e(o,{class:"mr-2 mb-3",warning:!0,variant:"outlined",text:"No, wait. Nevermind.","realm-icons":["cancel"],onClick:n=>d.value[t]=!1,isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(_,{class:"text-primary"},{default:a(()=>[e(r,{cols:"12",lg:"7"},{default:a(()=>[e(ce,{class:"realmImage mb-5",cover:"",src:p.value.imageLink,"lazy-src":"/images/mocks/placeholder-wide.jpg",alt:p.value.altText},null,8,["src","alt"])]),_:2},1024),e(r,{cols:"12",lg:"5"},{default:a(()=>[e(y,{class:"text-primary",errors:m(g)[`submissions[${t}].realm`],items:m(A).realmNames,hint:null,label:"Realm Name",name:`submissions[${t}].realmId`},null,8,["errors","items","name"]),e(k,{class:"text-primary",label:"Image Alt Text",name:`submissions[${t}].altText`,hint:null,"error-messages":m(g).altText},null,8,["name","error-messages"]),e(x,{name:`submissions[${t}].lore`,label:"Image Lore",errors:m(g)[`submissions[${t}].lore`]},null,8,["name","errors"]),i("p",je,":> Submitted by: "+T(p.value.submittedBy),1),i("p",we,":> Submitted around "+T(m(ge)(p.value.submittedAt).lastUpdated.value)+" ago",1),e(_,{class:"d-flex"},{default:a(()=>[e(r,{cols:"12",lg:"6"},{default:a(()=>[e(o,{class:"mr-2 mb-3",text:"Approve","realm-icons":["key"],onClick:n=>u.value[t]=!0},null,8,["onClick"])]),_:2},1024),e(r,{cols:"12",lg:"6"},{default:a(()=>[e(o,{class:"mr-2 mb-3",warning:"",variant:"outlined",text:"Reject","realm-icons":["cancel"],onClick:n=>d.value[t]=!0},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])}}};export{Ke as default};
