import{_ as M}from"./backButton.3ed8edb3.js";import{_ as z}from"./CBDropdownSelect.129af2f8.js";import G from"./CBTextField.635aa0b5.js";import P from"./CBTextArea.10efc8fb.js";import{_ as Z}from"./layout.e323096b.js";import{g as H}from"./composables.db01eee4.js";import{S as J,r as b,m as K,B as Q,k as W,Y as X,Z as ee,x as C,v as te,$ as ae,o as h,c as T,w as t,a0 as se,a1 as oe,a2 as le,a3 as re,a4 as ne,a as e,T as me,u as m,b as j,e as i,g as ie,a5 as ce,h as ue,F as pe,t as A}from"./entry.af4b25f0.js";import{c as B,b as de,a as S}from"./index.esm.f2d381c7.js";import{a as _e}from"./useRealmNames.4e993d8d.js";import{u as fe,a as ve}from"./useSiteStore.bfcdeead.js";import{V as _,a as r}from"./VRow.afde100a.js";import{V as be}from"./VContainer.84ccdb61.js";import{V as he}from"./VCard.1acd0fd0.js";import{V as N}from"./VOverlay.400edcb4.js";import{V as ge}from"./VImg.732dd834.js";import"./VIcon.4c30e4d0.js";import"./tag.622ed0d5.js";import"./color.16bf09b2.js";import"./useRender.711bb119.js";import"./VBtn.b508a718.js";import"./elevation.c0c3c7d4.js";import"./density.a43ed496.js";import"./rounded.2773415e.js";import"./router.4d4a04cb.js";import"./group.2a175b20.js";import"./index.8efa490c.js";import"./dimensions.85878954.js";import"./loader.a28a0d31.js";import"./VProgressLinear.58e0b888.js";import"./position.6ecf00cf.js";import"./VProgressCircular.a0eacb68.js";import"./resizeObserver.f5995fd7.js";import"./VTextField.6cbfc730.js";/* empty css                   */import"./forwardRefs.a44f5a39.js";import"./index.72f797fd.js";import"./VInput.6cafeb98.js";import"./transition.c0b5a353.js";import"./index.26545022.js";import"./createSimpleFunctional.e260b764.js";import"./VAvatar.1cb02f40.js";import"./VSelectionControl.a37bcff4.js";import"./VChip.b3e2a517.js";import"./hydration.80aaf091.js";const ye=i("h1",{class:"text-h1 text-center mb-4"},"Photo Approval",-1),ke={key:0},xe={class:"text-deep-orange-darken-1 d-flex align-center justify-center"},Ce=i("h2",{class:"text-h4"},"Are you sure you want to approve this submission?",-1),Se=i("p",{class:"text-body-1 mb-8"},"Submission approval is only reversable by a member of the D.I.S.",-1),Ve=i("h2",{class:"text-h4 mb-2"},"Are you sure you want to reject this submission?",-1),$e=i("p",{class:"text-body-1 mb-8"},"Rejecting a submission can not be undone.",-1),Ie={class:"text-body-1 text-primary mb-2"},we={class:"text-body-1 text-primary mb-4"},yt={__name:"photo-approval",async setup(Le){let f,V;_e();const F=fe(),R=([f,V]=J(()=>H()),f=await f,V(),f),U=b(0),u=b([]),p=b([]),c=b(!1),v=K(),$=async()=>{const s=se(re(v,"photographs"),le("published","==",!1),oe(4));(await ne(s)).forEach(o=>{E({...o.data(),photoId:o.id}),u.value.push(!1),p.value.push(!1)})};Q(()=>{$()});const{handleSubmit:I,errors:g}=W({validationSchema:B().shape({submissions:de().of(B().shape({realmId:S().required().label("Realm Name"),altText:S().nullable().max(150).label("Image Alt Text"),lore:S().max(120).required().label("Image Lore")}))})}),{remove:D,push:E,fields:w}=X("submissions"),L=s=>{D(s),c.value=!1,u.value[s]=!1,p.value[s]=!1,U.value--},O=I(({submissions:s},{evt:l})=>{c.value=!0;const{realmId:o,photoId:y,lore:k,altText:x}=s[l];ee(C(v,"realms",realm,"photographs",y),{published:!0,lore:k,altText:x,realmId:o}).then(()=>{L(l)})}),Y=I(({submissions:s},{evt:l})=>{c.value=!0,te(C(v,"users",R.uid,"rejections",s[l].imageId),{...s[l],rejectionReason:""}).then(()=>{ae(C(v,"submissions",s[l].imageId)),L(l)})});return(s,l)=>{const o=M,y=z,k=G,x=P,q=Z;return h(),T(q,{name:"sub-admin"},{default:t(()=>[e(be,{class:"my-5"},{default:t(()=>[e(_,{class:"mb-15"},{default:t(()=>[e(r,{cols:"12"},{default:t(()=>[ye]),_:1})]),_:1}),e(me,{name:"collapse"},{default:t(()=>[m(w).length?ie("",!0):(h(),j("div",ke,[e(_,null,{default:t(()=>[e(r,{cols:"12",md:"4",class:"offset-md-4"},{default:t(()=>[i("div",xe,[e(o,{rounded:"",text:"Check For More Submissions","front-icon":"magnify",onClick:l[0]||(l[0]=d=>$())})])]),_:1})]),_:1})]))]),_:1}),e(ce,{name:"collapse"},{default:t(()=>[(h(!0),j(pe,null,ue(m(w),(d,a)=>(h(),T(he,{variant:"outlined",color:"primary-darken-1",class:"pa-15 text-primary mb-8",key:d.value.imageId},{default:t(()=>[e(N,{modelValue:u.value[a],"onUpdate:modelValue":n=>u.value[a]=n,contained:"",class:"align-center background-red justify-center text-primary text-center approvalScrim"},{default:t(()=>[Ce,Se,e(_,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",text:"Yes, Approve This Submission","realm-icons":["check"],onClick:n=>m(O)(a),isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024),e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",warning:!0,variant:"outlined",text:"No, wait. Nevermind.",isLoading:c.value,"realm-icons":["cancel"],onClick:n=>u.value[a]=!1},null,8,["isLoading","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(N,{modelValue:p.value[a],"onUpdate:modelValue":n=>p.value[a]=n,contained:"",class:"align-center background-red justify-center text-primary text-center rejectionScrim"},{default:t(()=>[Ve,$e,e(_,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",text:"Yes, Reject This Submission","realm-icons":["trash-can"],onClick:n=>m(Y)(a),isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024),e(r,{cols:"12",md:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",warning:!0,variant:"outlined",text:"No, wait. Nevermind.","realm-icons":["cancel"],onClick:n=>p.value[a]=!1,isLoading:c.value},null,8,["onClick","isLoading"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(_,{class:"text-primary"},{default:t(()=>[e(r,{cols:"12",lg:"7"},{default:t(()=>[e(ge,{class:"realmImage mb-5",cover:"",src:d.value.imageLink,"lazy-src":"/images/mocks/placeholder-wide.jpg",alt:d.value.altText},null,8,["src","alt"])]),_:2},1024),e(r,{cols:"12",lg:"5"},{default:t(()=>[e(y,{class:"text-primary",errors:m(g)[`submissions[${a}].realm`],items:m(F).realmNames,hint:null,label:"Realm Name",name:`submissions[${a}].realmId`},null,8,["errors","items","name"]),e(k,{class:"text-primary",label:"Image Alt Text",name:`submissions[${a}].altText`,hint:null,"error-messages":m(g).altText},null,8,["name","error-messages"]),e(x,{name:`submissions[${a}].lore`,label:"Image Lore",errors:m(g)[`submissions[${a}].lore`]},null,8,["name","errors"]),i("p",Ie,":> Submitted by: "+A(d.value.submittedBy),1),i("p",we,":> Submitted around "+A(m(ve)(d.value.submittedAt).lastUpdated.value)+" ago",1),e(_,{class:"d-flex"},{default:t(()=>[e(r,{cols:"12",lg:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",text:"Approve","realm-icons":["key"],onClick:n=>u.value[a]=!0},null,8,["onClick"])]),_:2},1024),e(r,{cols:"12",lg:"6"},{default:t(()=>[e(o,{class:"mr-2 mb-3",caution:!0,variant:"outlined",text:"Reject","realm-icons":["cancel"],onClick:n=>p.value[a]=!0},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}};export{yt as default};
